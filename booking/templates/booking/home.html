{% extends 'booking/base.html' %}

{% block content %}
<div class="card">
    <h2>Search Buses</h2>
    <form method="GET" action="{% url 'search_buses' %}">
        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr auto; gap: 1rem; align-items: end;">
            <div class="form-group">
                <label>Travel Date</label>
                <input type="date" name="date" class="form-input" required min="{{ today }}" 
                       value="{{ date|default:'' }}">
            </div>
            <div class="form-group">
                <label>From</label>
                <input type="text" name="source" class="form-input" placeholder="Source city">
            </div>
            <div class="form-group">
                <label>To</label>
                <input type="text" name="destination" class="form-input" placeholder="Destination city">
            </div>
            <button type="submit" class="btn btn-primary">Search</button>
        </div>
    </form>
</div>

<h2 style="margin-top: 2rem;">Available Buses</h2>
<div class="grid">
    {% for bus in buses %}
    <div class="card">
        <h3>{{ bus.bus_name }}</h3>
        <p><strong>Bus No:</strong> {{ bus.bus_number }}</p>
        <p><strong>Route:</strong> {{ bus.source }} → {{ bus.destination }}</p>
        <p><strong>Departure:</strong> {{ bus.departure_time|time:"h:i A" }}</p>
        <p><strong>Arrival:</strong> {{ bus.arrival_time|time:"h:i A" }}</p>
        <p><strong>Duration:</strong> {{ bus.journey_duration }}</p>
        <p><strong>Total Seats:</strong> {{ bus.total_seats }}</p>
        <p><strong>Price:</strong> ₹{{ bus.price }}</p>
    </div>
    {% empty %}
    <p>No buses available</p>
    {% endfor %}
</div>

<script>
    document.querySelector('input[type="date"]').min = new Date().toISOString().split('T')[0];
</script>
{% endblock %}
